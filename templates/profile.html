{% extends "base.html" %}

{% block content %}

    <div class="container">
        <div class="row">
            <div class="col s12">
                <h1 class="center-align">{{ username }}&#8217;s Profile</h1>
            </div>
        </div>
        <div class="row">
            <div class="col s12">
                <h5 class="center-align">My Account</h5>
            </div>
        </div>
        <div class="row center-align">
            <div class="col s12">
                <p>Username &#58; <span>{{ username }}</span></p>
                <a href="{{ url_for('update_profile', username=username) }}" class="btn-large edit blue">Update Details</a>
            </div>
        </div>

        <div class="contributions-container">
            <div class="row">
                <div class="col s12">
                    <h2 class="center-align">My contributions</h2>
                </div>
            </div>
            {% for term in terms %}
                {% if term.created_by|lower == session.user|lower %}
                    <div class="row">
                        <div class="col s12 l4">
                            <span class="term-name">{{ term.term_name }}</span>
                        </div>
                        <div class="col s12 l8">
                            <span>{{ term.term_definition }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s6">
                            <a href="{{ url_for('delete_term', term_id=term._id) }}" class="btn-small delete right red">
                                <span>Delete term</span><i class="fas fa-trash-alt tooltipped" data-tooltip="DELETE TERM"></i>
                            </a>
                        </div>
                        <div class="col s6">
                            <a href="{{ url_for('edit_term', term_id=term._id) }}" class="btn-small edit blue">
                                <span>Edit details</span><i class="fas fa-pen-square tooltipped" data-tooltip="EDIT DETAILS"></i>
                            </a>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
            <div class="row center-align">
                <div class="col s12">
                    {% set total = [] %}
                    {% for term in terms if session.user|lower == term.created_by|lower %}
                        {% set i = term.contribution_value|int %}
                        {% if total.append(i) %}
                            {{ totals }}
                        {% endif %}
                    {% endfor %}
                    <p> You have made {{ total|sum }} contributions so far.</p>
                </div>
            </div>            
            <div class="row center-align add-entry">
                <div class="col-s12">
                    <a href="{{ url_for('add_definition') }}" class="btn-large add green">
                        {% if total|sum > 0 %}
                            Add another&#33;
                        {% else %}
                            Add term
                        {% endif %}
                    </a>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col s12">
                <h2 class="center-align">Delete Account</h2>
            </div>
        </div>
        <div class="row center-align">
            <div class="col s12">
                <h4>Delete the account for {{ username }}</h4>
            </div>
        </div>
        <div class="row center-align">
            <div class="col s12">
                <p class="warning"><i class="fas fa-exclamation-triangle"></i> Warning&#33; This action cannot be undone&#33; You should only take this action if you are certain you want to delete your account.</p>
                <a class="btn-large delete red" href="{{ url_for('delete_account', username=username)}}">Delete Account</a>
            </div>
        </div>
    </div>

{% endblock %}